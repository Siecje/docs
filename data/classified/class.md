Модули и классы
===============


Модули
------


Весь webix4 построен из модулей. Каждый модуль это js объект у которого могут быть как данные так и методы. Объекты можно объеденять через webix.extend

~~~js
var a = { name:"a", value:"123" };
var b = { name:"b", solution:true };


//результат содержит поля из двух объектов
//существующие поля не перезатираются !
webix.extend(a,b); // {name:"a", value:"123", solution:true};

//однако, если выставить третий параметр - существующие поля 
//также заменятся полями из второго объекта
webix.extend(a,b, true); // {name:"b", value:"123", solution:true};
~~~


### Конструкторы

Каждый модуль может содержать $init метод, который будет вызван при инициализации модуля

~~~js
var a = { name:"a", value:"123" };
var b = { name:"b", $init:function(){  this.solution = true; }};


webix.extend(a,b); // a.solution == true;
~~~

### Для чего можно использовать

В модули выносятся самостоятельные блоки функциональности, которые могут в последствии использоваться в других компонентах.

Желательно чтобы модель не использовал приватные переменные извне, и не предполагал что чуждый код будет использовать его приватные переменный ( в тоже время работа с паблик переменными/методами других модулей - вполне легальна )   

За исключением специализированных модулей - прямой работы с html быть не должно

  - если информацию можно добыть через паблик апи других модулей - она должна быть взята оттуда
  - если информация не доступна через паблик апи других модулей - это сигнал что их апи возможно несовершенно и может быть улучшено


### Именование

Модули сохраняются в глобальный namespace webix, имена начинаются с большой буквы ( физическое расположение sources/core/ ) 

~~~js
webix.MouseEvents = { ... };
~~~



Классы, первое приближение
--------------------------


### Насследование
 
Использую webix.extend мы можем добавлять объекту свойства любых других модулей, при этом вызовутся все их конструкторы - обеспечивая правильную инициализацию 
~~~js
//примитивный класс
var myui = function(){
    some_init_code();
    this.method = function(){ ... };
    
    webix.extend(this, webix.MouseEvents);
    webix.extend(this, webix.SingleRender);
}
var subui = function(){
    webix.extend(this, myui); //наследуемся от myui
}
~~~

### Приватные методы

методы которые начинаются с "_" считаются приватными, в релиз версии они обфусцируются, так что их спользование извне webix кода невозможно


Классы, второе приближение
--------------------------

У вышеприведенного апи есть две проблемы

- надо постоянно повторять webix.extend
- оно тратит кучу циклов на копипрование пропертей ( для каждого инстанса объекта ) 

Чтобы решить эту проблему был создан отдельны интерфейс для создания новых классов на основе моделей
{{note вообще особой разницы между классами и модулями нет }}

~~~js
webix.protoUI({
   ... class specific methods and properties ...
}, moduleN, ... module2, module1)
~~~

вышеприведенный код можно записать как 

~~~js
webix.protoUI({
    name:"myui",
    $init: function(){ some_init_code(); },
    method: function(){ ... }
}, webix.MouseEvents, webix.SingleRender );

webix.protoUI({
    name:"subui"
}, webix.myui);

var some = new webix.ui.subui();
~~~

- $init - конструктор как и у модуля 
- name - имя класса, класс будет сохранен как webix.ui.{name}, имена классов должны быть lowercase

Если у класса много потомков, то они применяются справа на лево ( самый правый - самый первый ) 

### Конфигурирование

Классы сами по себе не отличаются от модулей, но если подмешать в класс webix.Settings - их можно будет конфигурировать через конструктор

~~~js
webix.protoUI({
   name:"myclass"
}, webix.Settings);

var some = new webix.ui.myclass({ prop:1 });
alert(some.config.prop); //1
~~~

Класс может содержать коллекцию дефолтных значений для возможных опций 

~~~js
webix.protoUI({
   name:"myclass",
   defaults:{
    prop:1,
    myprop:2
   }
}, webix.Settings);

var some = new webix.ui.myclass({ prop:3 });
alert(some.config.prop); //3
alert(some.config.myprop); //2
~~~

defaults объявленные в разных модулях объеденяются в финальном классе ( то есть не теряются ) 

### Практическое применение

На практике webix.protoUI используется для построению ui компонент так что в списке модулей оснований должен быть один webix.ui класс и сколько угодно отдельных модулей. 


~~~js
webix.protoUI({
   name:"myview"   
}, webix.MouseEvents, webix.ui.view);
~~~

конечно же можно использовать не только webix.ui.view но и более сложные компоненты

~~~js
//custom datatable with different initial options
webix.protoUI({
   name:"mygrid", 
   defaults:{
      select:true,
      drag;true
   }
}, webix.ui.datatable);
~~~


Дополнительное чтиво
--------------------

[Туториал по созданию своей компоненты](http://docs.Webix.com/touch/doku.php?id=creating_custom_components)